(function(){function e(t,e,r){;"use strict";var a=jQuery(e);var n=jQuery(r);if(a.length===0){throw Error("No element selected by the searchSelector")}if(n.length===0){throw Error("No element selected by the resultSelector")}if(n.attr("class").indexOf("list-group-item")===-1){n.html('<div class="m-auto text-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div><br/>Loading...</div>')}var c=[];if(window.location.pathname.indexOf("/culture/movies")!==-1){jQuery.ajax({url:"https://api.chuanfang.org/trakt/index",dataType:"json",success:function(t){var e=t.data.movie;var r=[];if(e!==""){var a=JSON.parse(atob(e));for(var n=0;n<a.length;n++){var i=a[n];r.push({title:i.title,content:i.content,url:i.url})}}c=r}})}else if(window.location.pathname.indexOf("/culture/shows")!==-1){jQuery.ajax({url:"https://api.chuanfang.org/trakt/index",dataType:"json",success:function(t){var e=t.data.show;var r=[];if(e!==""){var a=JSON.parse(atob(e));for(var n=0;n<a.length;n++){var i=a[n];r.push({title:i.title,content:i.content,url:i.url})}}c=r}})}else if(window.location.pathname.indexOf("/culture/")!==-1){jQuery.ajax({url:"https://api.chuanfang.org/trakt/index",dataType:"json",success:function(t){var e=t.data.movie;var r=t.data.show;var a=[];if(e!==""){var n=JSON.parse(atob(e));for(var i=0;i<n.length;i++){var l=n[i];a.push({title:l.title,content:l.content,url:l.url})}}if(r!==""){var s=JSON.parse(atob(r));for(var i=0;i<s.length;i++){var o=s[i];a.push({title:o.title,content:o.content,url:o.url})}}c=a}})}else{jQuery.ajax({url:t,dataType:"xml",success:function(t){c=jQuery("entry",t).map(function(){return{title:jQuery("title",this).text(),content:jQuery("content",this).text(),url:jQuery("url",this).text()}}).get()}})}if(n.html().indexOf("list-group-item")===-1){n.html("")}a.on("input",function(){var t=a.val();var d="";var p=t.trim().toLowerCase().split(/[\s-]+/);n.html("");if(t.trim().length<=0){return a.removeClass("invalid").removeClass("valid")}c.forEach(function(t){var r=true;if(!t.title||t.title.trim()===""){t.title="Untitled"}var e=t.title.trim();var a=e.toLowerCase();var n=t.content.trim().replace(/<[^>]+>/g,"");var i=n.toLowerCase();var l=t.url;var s=-1;var o=-1;var c=-1;if(CONFIG.include_content_in_search&&i===""){r=false}else{p.forEach(function(t,e){s=a.indexOf(t);o=i.indexOf(t);if(s<0&&o<0){r=false}else{if(o<0){o=0}if(e===0){c=o}}})}if(r){d+="<a href='"+l+"' class='list-group-item list-group-item-action font-weight-bolder search-list-title'   target='_blank'>"+e+"</a>";var u=n;if(c>=0){var v=c-20;var h=c+80;if(v<0){v=0}if(v===0){h=100}if(h>u.length){h=u.length}var f=u.substring(v,h);p.forEach(function(t){var e=new RegExp(t,"gi");f=f.replace(e,'<span class="search-word">'+t+"</span>")});d+="<p class='search-list-content'>"+f+"...</p>"}}});if(d.indexOf("list-group-item")===-1){return a.addClass("invalid").removeClass("valid")}a.addClass("valid").removeClass("invalid");n.html(d)})}function t(t,e){"use strict";var r=jQuery(t);var a=jQuery(e);if(r.length===0){throw Error("No element selected by the searchSelector")}if(a.length===0){throw Error("No element selected by the resultSelector")}r.val("").removeClass("invalid").removeClass("valid");a.html("")}var r=jQuery("#modalSearch");var a="#local-search-input";var n="#local-search-result";r.on("show.bs.modal",function(){var t=CONFIG.search_path||"/local-search.xml";e(t,a,n)});r.on("shown.bs.modal",function(){jQuery("#local-search-input").focus()});r.on("hidden.bs.modal",function(){t(a,n)})})();